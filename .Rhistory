#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
guides(fill = guide_legend(title="New Legend Title"))
#scale_y_log10() + scale_x_log10()
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau(name = "New legend title")
#scale_y_log10() + scale_x_log10()
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
theme(legend.position = "none") +
scale_fill_continuous_tableau(name = "New legend title")
#scale_y_log10() + scale_x_log10()
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
p$labels$fill <- "test"
#scale_y_log10() + scale_x_log10()
p
p$labels$color <- "test"
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
p$labels$color <- "test"
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(legend.position = "bottom", text = element_text(size = 20),
axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() + labs(fill='NEW LEGEND TITLE')
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() + labs(fill='NEW LEGEND TITLE')
#p$labels$color <- "test"
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
guide_legend(title="my awesome title")
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
guides(fill=guide_legend(title="my awesome title"))
#p$labels$color <- "test"
p
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE")
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
#scale_y_log10() + scale_x_log10()
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
#scale_y_log10() + scale_x_log10()
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
#scale_y_log10() + scale_x_log10()
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
#theme(legend.position = "none") +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = comb, color = comb)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
theme(legend.position = "none")
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
df$`precision * closeness` <- df$closeness * df$ratio
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * closeness`, color = `precision * closeness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau() +
#scale_y_log10() + scale_x_log10()
#p$labels$color <- "test"
update_labels(p, list(colour="MY NEW LEGEND TITLE"))
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * closeness`, color = `precision * closeness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
ggsave2("precision_closeness_final.svg", plot = p)
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * \ncloseness`,
color = `precision * \ncloseness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
df$`precision * \ncloseness` <- df$closeness * df$ratio
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * \ncloseness`,
color = `precision * \ncloseness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
#theme(legend.position = "bottom", text = element_text(size = 20),
#      axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
ggsave2("precision_closeness_final.svg", plot = p)
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * \ncloseness`,
color = `precision * \ncloseness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * \ncloseness`,
color = `precision * \ncloseness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Closeness") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(text = element_text(size = 20),
axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `precision * \ncloseness`,
color = `precision * \ncloseness`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Centrality") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(text = element_text(size = 20),
axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
ggsave2("precision_closeness_final.svg", plot = p)
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `Precision * \nCentrality`,
color = `Precision * \nCentrality`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Centrality") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(text = element_text(size = 20),
axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
df$`Precision * \nCentrality` <- df$closeness * df$ratio
p <- ggplot(df, aes(x = closeness, y = ratio)) +
geom_point(size = 3, shape = 21, alpha=0.7, aes(fill = `Precision * \nCentrality`,
color = `Precision * \nCentrality`)) +
#ggtitle("Precision - Closeness plot", "Metabolite - Gene Ontology associations") +
xlab("Centrality") + ylab("Precision") +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = thres_close, xmax = 1, ymin = 0, ymax = thres_ratio, fill = "gray", alpha = 0.3) +
#annotate("rect", xmin = 0, xmax = thres_close, ymin = thres_ratio, ymax = 1, fill = "gray", alpha = 0.3) +
#geom_segment(aes(x=thres_close, xend=thres_close, y=thres_ratio, yend=1)) +
#geom_segment(aes(x=thres_close, xend=1, y=thres_ratio, yend=thres_ratio)) +
#geom_segment(aes(x=thres_close, xend=1, y=1, yend=1)) +
#geom_segment(aes(x=1, xend=1, y=thres_ratio, yend=1)) +
#geom_label_repel(data=subset(sub, ratio > thres_ratio & closeness > thres_close), aes(label = GO, fill = name), color = 'white', size = 3.5) +
xlim(0, 1) +
ylim(0, 1) +
theme_minimal() +
theme(text = element_text(size = 20),
axis.text = element_text(size = 20)) +
scale_fill_continuous_tableau() +
scale_color_continuous_tableau()
#p$labels$color <- "test"
p
ggsave2("precision_closeness_final.svg", plot = p)
